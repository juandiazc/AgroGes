camposDecimal = ['txt_F4_S1_P1_4','txt_F4_S1_P2_4','txt_F4_S1_P3_4','txt_F4_S1_P4_4','txt_F4_S1_P5_4','txt_F4_S1_P6_4',
'txt_F4_S1_P7_4','txt_F4_S1_P8_4','txt_F4_S1_P9_4','txt_F4_S1_P10_4','txt_F4_S1_P11_4','txt_F4_S1_P12_4',
'txt_F4_S1_P13_4','txt_F4_S1_P14_4','txt_F4_S1_P15_4','txt_F4_S1_P16_4','txt_F4_S1_P17_4','txt_F4_S1_P18_4',
'txt_F4_S1_P19_4','txt_F4_S1_P20_4','txt_F4_S1_P21_4','txt_F4_S1_P22_4','txt_F4_S1_P23_4','txt_F4_S1_P24_4',
'txt_F4_S1_P25_4','txt_F4_S1_P26_4','txt_F4_S1_P27_4','txt_F4_S1_P28_4','txt_F4_S1_P29_4','txt_F4_S1_P30_4','txt_F4_S1_P41_4',
'txt_F4_S1_P1_6','txt_F4_S1_P2_6','txt_F4_S1_P3_6','txt_F4_S1_P4_6','txt_F4_S1_P5_6','txt_F4_S1_P6_6',
'txt_F4_S1_P7_6','txt_F4_S1_P8_6','txt_F4_S1_P9_6','txt_F4_S1_P10_6','txt_F4_S1_P11_6','txt_F4_S1_P12_6',
'txt_F4_S1_P13_6','txt_F4_S1_P14_6','txt_F4_S1_P15_6','txt_F4_S1_P16_6','txt_F4_S1_P17_6','txt_F4_S1_P18_6',
'txt_F4_S1_P19_6','txt_F4_S1_P20_6','txt_F4_S1_P21_6','txt_F4_S1_P22_6','txt_F4_S1_P23_6','txt_F4_S1_P24_6',
'txt_F4_S1_P25_6','txt_F4_S1_P26_6','txt_F4_S1_P27_6','txt_F4_S1_P28_6','txt_F4_S1_P29_6','txt_F4_S1_P30_6','txt_F4_S1_P41_6',
'txt_F4_S1_P1_7','txt_F4_S1_P2_7','txt_F4_S1_P3_7','txt_F4_S1_P4_7','txt_F4_S1_P5_7','txt_F4_S1_P6_7',
'txt_F4_S1_P7_7','txt_F4_S1_P8_7','txt_F4_S1_P9_7','txt_F4_S1_P10_7','txt_F4_S1_P11_7','txt_F4_S1_P12_7',
'txt_F4_S1_P13_7','txt_F4_S1_P14_7','txt_F4_S1_P15_7','txt_F4_S1_P16_7','txt_F4_S1_P17_7','txt_F4_S1_P18_7',
'txt_F4_S1_P19_7','txt_F4_S1_P20_7','txt_F4_S1_P21_7','txt_F4_S1_P22_7','txt_F4_S1_P23_7','txt_F4_S1_P24_7',
'txt_F4_S1_P25_7','txt_F4_S1_P26_7','txt_F4_S1_P27_7','txt_F4_S1_P28_7','txt_F4_S1_P29_7','txt_F4_S1_P30_7','txt_F4_S1_P41_7',
'txt_F4_S1_P1_8','txt_F4_S1_P2_8','txt_F4_S1_P3_8','txt_F4_S1_P4_8','txt_F4_S1_P5_8','txt_F4_S1_P6_8',
'txt_F4_S1_P7_8','txt_F4_S1_P8_8','txt_F4_S1_P9_8','txt_F4_S1_P10_8','txt_F4_S1_P11_8','txt_F4_S1_P12_8',
'txt_F4_S1_P13_8','txt_F4_S1_P14_8','txt_F4_S1_P15_8','txt_F4_S1_P16_8','txt_F4_S1_P17_8','txt_F4_S1_P18_8',
'txt_F4_S1_P19_8','txt_F4_S1_P20_8','txt_F4_S1_P21_8','txt_F4_S1_P22_8','txt_F4_S1_P23_8','txt_F4_S1_P24_8',
'txt_F4_S1_P25_8','txt_F4_S1_P26_8','txt_F4_S1_P27_8','txt_F4_S1_P28_8','txt_F4_S1_P29_8','txt_F4_S1_P30_8',
'txt_F4_S1_P41_8','txt_F4_S1_P42_8','txt_F4_S1_P43_8','txt_F4_S1_P44_8','txt_F4_S1_P45_8','txt_F4_S1_P46_8',
'txt_F4_S1_P1_10','txt_F4_S1_P2_10','txt_F4_S1_P3_10','txt_F4_S1_P4_10','txt_F4_S1_P5_10','txt_F4_S1_P6_10',
'txt_F4_S1_P7_10','txt_F4_S1_P8_10','txt_F4_S1_P9_10','txt_F4_S1_P10_10','txt_F4_S1_P11_10','txt_F4_S1_P12_10',
'txt_F4_S1_P13_10','txt_F4_S1_P14_10','txt_F4_S1_P15_10','txt_F4_S1_P16_10','txt_F4_S1_P17_10','txt_F4_S1_P18_10',
'txt_F4_S1_P19_10','txt_F4_S1_P20_10','txt_F4_S1_P21_10','txt_F4_S1_P22_10','txt_F4_S1_P23_10','txt_F4_S1_P24_10',
'txt_F4_S1_P25_10','txt_F4_S1_P26_10','txt_F4_S1_P27_10','txt_F4_S1_P28_10','txt_F4_S1_P29_10','txt_F4_S1_P30_10',
'txt_F4_S1_P41_10','txt_F4_S1_P42_10','txt_F4_S1_P43_10','txt_F4_S1_P44_10','txt_F4_S1_P45_10','txt_F4_S1_P46_10',
'txt_F4_S1_P1_11','txt_F4_S1_P2_11','txt_F4_S1_P3_11','txt_F4_S1_P4_11','txt_F4_S1_P5_11','txt_F4_S1_P6_11',
'txt_F4_S1_P7_11','txt_F4_S1_P8_11','txt_F4_S1_P9_11','txt_F4_S1_P10_11','txt_F4_S1_P11_11','txt_F4_S1_P12_11',
'txt_F4_S1_P13_11','txt_F4_S1_P14_11','txt_F4_S1_P15_11','txt_F4_S1_P16_11','txt_F4_S1_P17_11','txt_F4_S1_P18_11',
'txt_F4_S1_P19_11','txt_F4_S1_P20_11','txt_F4_S1_P21_11','txt_F4_S1_P22_11','txt_F4_S1_P23_11','txt_F4_S1_P24_11',
'txt_F4_S1_P25_11','txt_F4_S1_P26_11','txt_F4_S1_P27_11','txt_F4_S1_P28_11','txt_F4_S1_P29_11','txt_F4_S1_P30_11','txt_F4_S1_P41_11',
'txt_F4_S1_P1_12','txt_F4_S1_P2_12','txt_F4_S1_P3_12','txt_F4_S1_P4_12','txt_F4_S1_P5_12','txt_F4_S1_P6_12',
'txt_F4_S1_P7_12','txt_F4_S1_P8_12','txt_F4_S1_P9_12','txt_F4_S1_P10_12','txt_F4_S1_P11_12','txt_F4_S1_P12_12',
'txt_F4_S1_P13_12','txt_F4_S1_P14_12','txt_F4_S1_P15_12','txt_F4_S1_P16_12','txt_F4_S1_P17_12','txt_F4_S1_P18_12',
'txt_F4_S1_P19_12','txt_F4_S1_P20_12','txt_F4_S1_P21_12','txt_F4_S1_P22_12','txt_F4_S1_P23_12','txt_F4_S1_P24_12',
'txt_F4_S1_P25_12','txt_F4_S1_P26_12','txt_F4_S1_P27_12','txt_F4_S1_P28_12','txt_F4_S1_P29_12','txt_F4_S1_P30_12','txt_F4_S1_P41_12',
'txt_F4_S1_P1_13','txt_F4_S1_P2_13','txt_F4_S1_P3_13','txt_F4_S1_P4_13','txt_F4_S1_P5_13','txt_F4_S1_P6_13',
'txt_F4_S1_P7_13','txt_F4_S1_P8_13','txt_F4_S1_P9_13','txt_F4_S1_P10_13','txt_F4_S1_P11_13','txt_F4_S1_P12_13',
'txt_F4_S1_P13_13','txt_F4_S1_P14_13','txt_F4_S1_P15_13','txt_F4_S1_P16_13','txt_F4_S1_P17_13','txt_F4_S1_P18_13',
'txt_F4_S1_P19_13','txt_F4_S1_P20_13','txt_F4_S1_P21_13','txt_F4_S1_P22_13','txt_F4_S1_P23_13','txt_F4_S1_P24_13',
'txt_F4_S1_P25_13','txt_F4_S1_P26_13','txt_F4_S1_P27_13','txt_F4_S1_P28_13','txt_F4_S1_P29_13','txt_F4_S1_P30_13','txt_F4_S1_P41_13'];
camposletra=['txt_F4_S1_P1_1','txt_F4_S1_P2_1','txt_F4_S1_P3_1','txt_F4_S1_P4_1','txt_F4_S1_P5_1','txt_F4_S1_P6_1',
'txt_F4_S1_P7_1','txt_F4_S1_P8_1','txt_F4_S1_P9_1','txt_F4_S1_P10_1','txt_F4_S1_P11_1','txt_F4_S1_P12_1',
'txt_F4_S1_P13_1','txt_F4_S1_P14_1','txt_F4_S1_P15_1','txt_F4_S1_P16_1','txt_F4_S1_P17_1','txt_F4_S1_P18_1',
'txt_F4_S1_P19_1','txt_F4_S1_P20_1','txt_F4_S1_P21_1','txt_F4_S1_P22_1','txt_F4_S1_P23_1','txt_F4_S1_P24_1',
'txt_F4_S1_P25_1','txt_F4_S1_P26_1','txt_F4_S1_P27_1','txt_F4_S1_P28_1','txt_F4_S1_P29_1','txt_F4_S1_P30_1',
'txt_F4_S1_P1_2','txt_F4_S1_P2_2','txt_F4_S1_P3_2','txt_F4_S1_P4_2','txt_F4_S1_P5_2','txt_F4_S1_P6_2',
'txt_F4_S1_P7_2','txt_F4_S1_P8_2','txt_F4_S1_P9_2','txt_F4_S1_P10_2','txt_F4_S1_P11_2','txt_F4_S1_P12_2',
'txt_F4_S1_P13_2','txt_F4_S1_P14_2','txt_F4_S1_P15_2','txt_F4_S1_P16_2','txt_F4_S1_P17_2','txt_F4_S1_P18_2',
'txt_F4_S1_P19_2','txt_F4_S1_P20_2','txt_F4_S1_P21_2','txt_F4_S1_P22_2','txt_F4_S1_P23_2','txt_F4_S1_P24_2',
'txt_F4_S1_P25_2','txt_F4_S1_P26_2','txt_F4_S1_P27_2','txt_F4_S1_P28_2','txt_F4_S1_P29_2','txt_F4_S1_P30_2',
'txt_F4_S1_P1_3','txt_F4_S1_P2_3','txt_F4_S1_P3_3','txt_F4_S1_P4_3','txt_F4_S1_P5_3','txt_F4_S1_P6_3',
'txt_F4_S1_P7_3','txt_F4_S1_P8_3','txt_F4_S1_P9_3','txt_F4_S1_P10_3','txt_F4_S1_P11_3','txt_F4_S1_P12_3',
'txt_F4_S1_P13_3','txt_F4_S1_P14_3','txt_F4_S1_P15_3','txt_F4_S1_P16_3','txt_F4_S1_P17_3','txt_F4_S1_P18_3',
'txt_F4_S1_P19_3','txt_F4_S1_P20_3','txt_F4_S1_P21_3','txt_F4_S1_P22_3','txt_F4_S1_P23_3','txt_F4_S1_P24_3',
'txt_F4_S1_P25_3','txt_F4_S1_P26_3','txt_F4_S1_P27_3','txt_F4_S1_P28_3','txt_F4_S1_P29_3','txt_F4_S1_P30_3'];
camposMiles=['txt_F4_S1_P1_5','txt_F4_S1_P2_5','txt_F4_S1_P3_5','txt_F4_S1_P4_5','txt_F4_S1_P5_5','txt_F4_S1_P6_5',
'txt_F4_S1_P7_5','txt_F4_S1_P8_5','txt_F4_S1_P9_5','txt_F4_S1_P10_5','txt_F4_S1_P11_5','txt_F4_S1_P12_5',
'txt_F4_S1_P13_5','txt_F4_S1_P14_5','txt_F4_S1_P15_5','txt_F4_S1_P16_5','txt_F4_S1_P17_5','txt_F4_S1_P18_5',
'txt_F4_S1_P19_5','txt_F4_S1_P20_5','txt_F4_S1_P21_5','txt_F4_S1_P22_5','txt_F4_S1_P23_5','txt_F4_S1_P24_5',
'txt_F4_S1_P25_5','txt_F4_S1_P26_5','txt_F4_S1_P27_5','txt_F4_S1_P28_5','txt_F4_S1_P29_5','txt_F4_S1_P30_5',
'txt_F4_S1_P41_5','txt_F4_S1_P42_5','txt_F4_S1_P43_5','txt_F4_S1_P44_5','txt_F4_S1_P45_5','txt_F4_S1_P46_5',
'txt_F4_S1_P1_9','txt_F4_S1_P2_9','txt_F4_S1_P3_9','txt_F4_S1_P4_9','txt_F4_S1_P5_9','txt_F4_S1_P6_9',
'txt_F4_S1_P7_9','txt_F4_S1_P8_9','txt_F4_S1_P9_9','txt_F4_S1_P10_9','txt_F4_S1_P11_9','txt_F4_S1_P12_9',
'txt_F4_S1_P13_9','txt_F4_S1_P14_9','txt_F4_S1_P15_9','txt_F4_S1_P16_9','txt_F4_S1_P17_9','txt_F4_S1_P18_9',
'txt_F4_S1_P19_9','txt_F4_S1_P20_9','txt_F4_S1_P21_9','txt_F4_S1_P22_9','txt_F4_S1_P23_9','txt_F4_S1_P24_9',
'txt_F4_S1_P25_9','txt_F4_S1_P26_9','txt_F4_S1_P27_9','txt_F4_S1_P28_9','txt_F4_S1_P29_9','txt_F4_S1_P30_9',
'txt_F4_S1_P41_9','txt_F4_S1_P42_9','txt_F4_S1_P43_9','txt_F4_S1_P44_9','txt_F4_S1_P45_9','txt_F4_S1_P46_9'];
campoSoloTexto=[];
function validar (campo_j){
    campo_j = "#"+campo_j;
    //Reglas 1 al 12
    for (i=1;i<31;i++)
    {
        //Regla 1
        if ($(campo_j).attr('id')=='txt_F4_S1_P'+i+'_13')
        {
        campo04=$.trim($('#txt_F4_S1_P'+i+'_4').val());
        campo05=$.trim($('#txt_F4_S1_P'+i+'_5').val());
        campo06=$.trim($('#txt_F4_S1_P'+i+'_6').val());
        campo07=$.trim($('#txt_F4_S1_P'+i+'_7').val());
        campo08=$.trim($('#txt_F4_S1_P'+i+'_8').val());
        campo09=$.trim($('#txt_F4_S1_P'+i+'_9').val());
        campo10=$.trim($('#txt_F4_S1_P'+i+'_10').val());
        campo11=$.trim($('#txt_F4_S1_P'+i+'_11').val());
        campo12=$.trim($('#txt_F4_S1_P'+i+'_12').val());
        campo13=$.trim($('#txt_F4_S1_P'+i+'_13').val());
        suma1=eliminar_miles(campo05)+eliminar_miles(campo09);
        suma2=eliminar_decimales(campo04)+eliminar_decimales(campo06)+eliminar_decimales(campo07)+eliminar_miles(campo08)+eliminar_decimales(campo10)+eliminar_decimales(campo11)+eliminar_decimales(campo12)+eliminar_decimales(campo13);
        total=parseFloat(suma1)+parseFloat(suma2);
        if ($.trim($('#txt_F4_S1_P'+i+'_2').val()).length  == 0 && total > 0)
		    {
		                    CONT =i;
							if (perfil == 4)
							{
							if(!confirm('Advertencia: No informa nombre detallado del producto.\n ¿Desea continuar?'))
								{
								$('#txt_F4_S1_P'+CONT+'_2').focus();
								$('#txt_F4_S1_P'+CONT+'_2').select();
								return false;
								}
								else
								{
								flag_2 = true;
								FILASGTE=CONT+1;
								$('#txt_F4_S1_P'+FILASGTE+'_1').focus();
								return false;
								}  
							break;								
							}
							else 
							{
						    alert("Error: No informa nombre de la materia prima comprada.");
						    $('#txt_F4_S1_P'+CONT+'_2').focus();
						    $('#txt_F4_S1_P'+CONT+'_2').select();
						     return false; 
						   	break;	
							}
							
		    }
        }
        //Regla 2
        if ($(campo_j).attr('id')=='ddl_F4_S1_P'+i+'_3')
        {
       
        if ($.trim($('#txt_F4_S1_P'+i+'_2').val()).length  != 0 && $.trim($('#ddl_F4_S1_P'+i+'_3').val()).length == 0 )
		    {
				CONT =i;
							if (perfil == 4)
							{
							if(!confirm('Advertencia: No indica unidad de medida.\n ¿Desea continuar?'))
								{
								$(campo_j).focus();
								$(campo_j).select();
								return false;
								}
								else
								{
								flag_2 = true;
								$('#txt_F4_S1_P'+CONT+'_4').focus();
								return false;
								}  
							break;								
							}
							else 
							{
							alert("Error: No indica unidad de medida.");
							$(campo_j).focus();
							$(campo_j).select();
							return false; 
							break;
							}							
							
		    }
        } 
        //Regla 3
        if ($(campo_j).attr('id')=='txt_F4_S1_P'+i+'_5')
        {
        campo04=$.trim($('#txt_F4_S1_P'+i+'_4').val());
        campo05=$.trim($('#txt_F4_S1_P'+i+'_5').val());
        if ( eliminar_decimales(campo04) == 0 && eliminar_miles(campo05)>0 )
		    {
							CONT =i;
							if (perfil == 4)
							{
							if(!confirm('Advertencia: Informa valor pero no cantidad traspasada.\n ¿Desea continuar?'))
								{
								$('#txt_F4_S1_P'+CONT+'_4').focus();
								$('#txt_F4_S1_P'+CONT+'_4').select();
								return false;
								}
								else
								{
								flag_2 = true;
								$('#txt_F4_S1_P'+CONT+'_6').focus();
								return false;
								}  
							break;								
							}
							else 
							{
						    alert("Error: Informa valor pero no cantidad traspasada.");
						    $('#txt_F4_S1_P'+CONT+'_4').focus();
						    $('#txt_F4_S1_P'+CONT+'_4').select();
						     return false; 
						   	break;
							}							
							
		    }
        } 
        		//Regla 4
        if ($(campo_j).attr('id')=='txt_F4_S1_P'+i+'_5')
        {
        campo04=$.trim($('#txt_F4_S1_P'+i+'_4').val());
        campo05=$.trim($('#txt_F4_S1_P'+i+'_5').val());
        if ( eliminar_decimales(campo04) > 0 && eliminar_miles(campo05)==0 )
		    {
					CONT =i;
							if (perfil == 4)
							{
							if(!confirm('Advertencia: Informa cantidad pero no valor de traspaso.\n ¿Desea continuar?'))
								{
								$(campo_j).focus();
								$(campo_j).select();
								return false;
								}
								else
								{
								flag_2 = true;
								$('#txt_F4_S1_P'+CONT+'_6').focus();
								return false;
								}  
							break;								
							}
							else 
							{
						    alert("Error: Informa cantidad pero no valor de traspaso.");
						    $(campo_j).focus();
						    $(campo_j).select();
						     return false; 
						   	break;
							}							
							
		    }
        } 
 		//Regla 5
        if ($(campo_j).attr('id')=='txt_F4_S1_P'+i+'_7')
        {
        campo07=$.trim($('#txt_F4_S1_P'+i+'_7').val());
        if ($.trim($('#txt_F4_S1_P'+i+'_2').val()).length  != 0 && eliminar_decimales(campo07) == 0 )
		    {
		        cont=i;
			    if(!confirm('Advertencia: Informa materia prima pero no indica cantidad comprada.\n ¿Desea continuar?')){
                $(campo_j).focus();
                $(campo_j).select();
                return false;
                }else{
                flag_2 = true;
                $('#txt_F4_S1_P'+cont+'_8').focus();
                return false;
                }
			    break;	
							
		    }
        } 
        //Regla 6
        if ($(campo_j).attr('id')=='txt_F4_S1_P'+i+'_8')
        {
        campo07=$.trim($('#txt_F4_S1_P'+i+'_7').val());
        campo08=$.trim($('#txt_F4_S1_P'+i+'_8').val());
        if ( eliminar_decimales(campo07) > 0 && eliminar_miles(campo08)==0 )
		    {
				CONT =i;
							if (perfil == 4)
							{
							if(!confirm('Advertencia: IInforma cantidad comprada pero no valor de la compra.\n ¿Desea continuar?'))
								{
								$(campo_j).focus();
								$(campo_j).select();
								return false;
								}
								else
								{
								flag_2 = true;
								$('#txt_F4_S1_P'+CONT+'_9').focus();
								return false;
								}  
							break;								
							}
							else 
							{
						    alert("Error: Informa cantidad comprada pero no valor de la compra.");
						    $(campo_j).focus();
						    $(campo_j).select();
						     return false; 
						   	break;
							}							
							
		    }
        }  
        //Regla 7
        if ($(campo_j).attr('id')=='txt_F4_S1_P'+i+'_8')
        {
        campo07=$.trim($('#txt_F4_S1_P'+i+'_8').val());
        if ($.trim($('#txt_F4_S1_P'+i+'_2').val()).length  != 0 && eliminar_miles(campo08) == 0 )
		    {
		        cont=i;
			    if(!confirm('Advertencia: Informa materia prima pero valor de compra es cero.\n ¿Desea continuar?')){
                $(campo_j).focus();
                $(campo_j).select();
                return false;
                }else{
                flag_2 = true;
                $('#txt_F4_S1_P'+cont+'_9').focus();
                return false;
                }
			    break;	
							
		    }
        } 
        //Regla 8
        if ($(campo_j).attr('id')=='txt_F4_S1_P'+i+'_8')
        {
        campo07=$.trim($('#txt_F4_S1_P'+i+'_7').val());
        campo08=$.trim($('#txt_F4_S1_P'+i+'_8').val());
        if ( eliminar_decimales(campo07)== 0 && eliminar_miles(campo08)>0 )
		    {   
					CONT =i;
							if (perfil == 4)
							{
							if(!confirm('Advertencia: Informa valor pero no cantidad comprada.\n ¿Desea continuar?'))
								{
								$('#txt_F4_S1_P'+CONT+'_7').focus();
								$('#txt_F4_S1_P'+CONT+'_7').select();
								return false;
								}
								else
								{
								flag_2 = true;
								$('#txt_F4_S1_P'+CONT+'_9').focus();
								return false;
								}  
							break;								
							}
							else 
							{
						    alert("Error: Informa valor pero no cantidad comprada.");
						    $('#txt_F4_S1_P'+CONT+'_7').focus();
						    $('#txt_F4_S1_P'+CONT+'_7').select();
						     return false; 
						   	break;	
							}
							
		    }
        }   
        //Regla 9
        if ($(campo_j).attr('id')=='txt_F4_S1_P'+i+'_12')
        {
        campo04=$.trim($('#txt_F4_S1_P'+i+'_4').val());
		campo06=$.trim($('#txt_F4_S1_P'+i+'_6').val());
		campo07=$.trim($('#txt_F4_S1_P'+i+'_7').val());
		campo12=$.trim($('#txt_F4_S1_P'+i+'_12').val());
		campo11=$.trim($('#txt_F4_S1_P'+i+'_11').val());
		suma=eliminar_decimales(campo04)+eliminar_decimales(campo06)-eliminar_decimales(campo07)-eliminar_decimales(campo12);
        if (eliminar_decimales(campo11) != suma)
		    {
                    cont=i;
					if(!confirm('Advertencia: Consumo del ejercicio inconsistente.\n ¿Desea continuar?')){
					$(campo_j).focus();
					$(campo_j).select();
					return false;
					}else{
					flag_2 = true;
					$('#txt_F4_S1_P'+cont+'_13').focus();
					return false;
					}
					break;	
							
		    }
        }
        //Regla 10
        if ($(campo_j).attr('id')=='txt_F4_S1_P'+i+'_9')
        {
        campo08=$.trim($('#txt_F4_S1_P'+i+'_8').val());
        campo09=$.trim($('#txt_F4_S1_P'+i+'_9').val());
        if ( eliminar_decimales(campo08) > 0 && eliminar_miles(campo09)==0 )
		    {
				CONT =i;
						if (perfil == 4)
						{
						if(!confirm('Advertencia: Informa valor de compra de materias primas y materiales, pero no el I.V.A.\n ¿Desea continuar?'))
							{
							$(campo_j).focus();
							$(campo_j).select();
							return false;
							}
							else
							{
							flag_2 = true;
							$('#txt_F4_S1_P'+CONT+'_10').focus();
							return false;
							}  
						break;								
						}
						else 
						{
						alert("Error: Informa valor de compra de materias primas y materiales, pero no el I.V.A.");
						$(campo_j).focus();
						$(campo_j).select();
						return false; 
						break;	
						}
		    }
        } 
        //Regla 11
        if ($(campo_j).attr('id')=='txt_F4_S1_P'+i+'_13')
        {
        campo13=$.trim($('#txt_F4_S1_P'+i+'_13').val());
        if ( eliminar_decimales(campo13) < 0 || eliminar_decimales(campo13)>100 )
		    {
					CONT =i;
						if (perfil == 4)
						{
						if(!confirm('Advertencia: % de importaciones fuera de rango (0-100%).\n ¿Desea continuar?'))
							{
							$(campo_j).focus();
							$(campo_j).select();
							return false;
							}
							else
							{
							flag_2 = true;
							FILASGTE=CONT+1;
							$('#txt_F4_S1_P'+FILASGTE+'_1').focus();
							return false;
							}  
						break;								
						}
						else 
						{
						    alert("Error: % de importaciones fuera de rango (0-100%).");
						    $(campo_j).focus();
						    $(campo_j).select();
						     return false; 
						   	break;
						}		
							
		    }
        } 
        //Regla 12
        if ($(campo_j).attr('id')=='txt_F4_S1_P'+i+'_10')
        {
        campo10=$.trim($('#txt_F4_S1_P'+i+'_10').val());
        if ( eliminar_decimales(campo10) < 0 || eliminar_decimales(campo10)>100 )
		    {
					CONT =i;
						if (perfil == 4)
						{
						if(!confirm('Advertencia: % de sobretasa fuera de rango (0-100%).\n ¿Desea continuar?'))
							{
							$(campo_j).focus();
							$(campo_j).select();
							return false;
							}
							else
							{
							flag_2 = true;
							$('#txt_F4_S1_P'+CONT+'_11').focus();
							return false;
							}  
						break;								
						}
						else 
						{
						    alert("Error: % de sobretasa fuera de rango (0-100%).");
						    $(campo_j).focus();
						    $(campo_j).select();
						     return false; 
						   	break;
						}			
							
		    }
        } 
         
           
    }
    
    
     //Regla 13
        if ($(campo_j).attr('id')=='txt_F4_S1_P41_4')
        {
        suma=0;
        for (i=1;i<31;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_4').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_decimales(campo)+parseFloat(suma);
			}
			campo41_4=$.trim($(campo_j).val())
		if (suma != eliminar_decimales(campo41_4))
                {
					if (perfil == 4)
					{
						if(!confirm('Advertencia: Subtotal (suma de control) cantidad traspasada no cuadra.\n ¿Desea continuar?'))
						{
						$('#txt_F4_S1_P1_4').focus();
						$('#txt_F4_S1_P1_4').select();
						return false;
						}
						else
						{
						flag_2 = true;
						$('#txt_F4_S1_P41_5').focus();
						return false;
						}    
					}
					else 
					{
					alert("Error: Subtotal (suma de control) cantidad traspasada no cuadra.");
                    $('#txt_F4_S1_P1_4').focus();
                    $('#txt_F4_S1_P1_4').select();
                    return false;
					}
                }
        } 
		  //Regla 14
        if ($(campo_j).attr('id')=='txt_F4_S1_P41_5')
        {
        suma=0;
        for (i=1;i<31;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_5').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_miles(campo)+suma;
			}
			campo41_5=$.trim($(campo_j).val())
		if (suma != eliminar_miles(campo41_5))
                {
					if (perfil == 4)
					{
						if(!confirm('Advertencia: Subtotal (suma de control) valor traspaso no cuadra.\n ¿Desea continuar?'))
						{
						$('#txt_F4_S1_P1_5').focus();
						$('#txt_F4_S1_P1_5').select();
						return false;
						}
						else
						{
						flag_2 = true;
						$('#txt_F4_S1_P41_6').focus();
						return false;
						}    
					}
					else 
					{
					alert("Error: Subtotal (suma de control) valor traspaso no cuadra.");
                    $('#txt_F4_S1_P1_5').focus();
                    $('#txt_F4_S1_P1_5').select();
                    return false;
					}
                }
        } 
            //Regla 15
        if ($(campo_j).attr('id')=='txt_F4_S1_P41_6')
        {
        suma=0;
        for (i=1;i<31;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_6').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_decimales(campo)+parseFloat(suma);
			}
			campo41_6=$.trim($(campo_j).val())
		if (suma != eliminar_decimales(campo41_6))
                {
					if (perfil == 4)
					{
						if(!confirm('Advertencia: Subtotal (suma de control) stock inicial no cuadra.\n ¿Desea continuar?'))
						{
						$('#txt_F4_S1_P1_6').focus();
						$('#txt_F4_S1_P1_6').select();
						return false;
						}
						else
						{
						flag_2 = true;
						$('#txt_F4_S1_P41_7').focus();
						return false;
						}    
					}
					else 
					{
					alert("Error: Subtotal (suma de control) stock inicial no cuadra.");
                    $('#txt_F4_S1_P1_6').focus();
                    $('#txt_F4_S1_P1_6').select();
                    return false;
					}
                }
        } 
            //Regla 16
        if ($(campo_j).attr('id')=='txt_F4_S1_P41_7')
        {
		suma=0;
        for (i=1;i<31;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_7').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_decimales(campo)+parseFloat(suma);
			}
			campo41_7=$.trim($(campo_j).val())
		if (suma != eliminar_decimales(campo41_7))
                {
					if (perfil == 4)
					{
						if(!confirm('Advertencia: Subtotal (suma de control) cantidad comprada no cuadra.\n ¿Desea continuar?'))
						{
						$('#txt_F4_S1_P1_7').focus();
						$('#txt_F4_S1_P1_7').select();
						return false;
						}
						else
						{
						flag_2 = true;
						$('#txt_F4_S1_P41_8').focus();
						return false;
						}    
					}
					else 
					{
					alert("Error: Subtotal (suma de control) cantidad comprada no cuadra.");
                    $('#txt_F4_S1_P1_7').focus();
                    $('#txt_F4_S1_P1_7').select();
                    return false;
					}
                }
        } 
            //Regla 17
        if ($(campo_j).attr('id')=='txt_F4_S1_P41_8')
        {
		suma=0;
        for (i=1;i<31;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_8').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_decimales(campo)+parseFloat(suma);
			}
			campo41_8=$.trim($(campo_j).val())
		if (suma != eliminar_decimales(campo41_8))
                {
					if (perfil == 4)
					{
						if(!confirm('Advertencia: Subtotal (suma de control) valor valor compra en moneda utilizada no cuadra.\n ¿Desea continuar?'))
						{
						$('#txt_F4_S1_P1_8').focus();
						$('#txt_F4_S1_P1_8').select();
						return false;
						}
						else
						{
						flag_2 = true;
						$('#txt_F4_S1_P41_9').focus();
						return false;
						}    
					}
					else 
					{
					alert("Error: Subtotal (suma de control) valor valor compra en moneda utilizada no cuadra.");
                    $('#txt_F4_S1_P1_8').focus();
                    $('#txt_F4_S1_P1_8').select();
                    return false;
					}
                }
        } 
            //Regla 18
        if ($(campo_j).attr('id')=='txt_F4_S1_P41_9')
        {
		suma=0;
        for (i=1;i<31;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_9').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_miles(campo)+suma;
			}
			campo41_9=$.trim($(campo_j).val())
		if (suma != eliminar_miles(campo41_9))
                {
					if (perfil == 4)
					{
						if(!confirm('Advertencia: Subtotal (suma de control) I.V.A. no cuadra.\n ¿Desea continuar?'))
						{
						$('#txt_F4_S1_P1_9').focus();
						$('#txt_F4_S1_P1_9').select();
						return false;
						}
						else
						{
						flag_2 = true;
						$('#txt_F4_S1_P41_10').focus();
						return false;
						}    
					}
					else 
					{
					alert("Error: Subtotal (suma de control) I.V.A. no cuadra.");
                    $('#txt_F4_S1_P1_9').focus();
                    $('#txt_F4_S1_P1_9').select();
                    return false;
					}
                }
        } 
            //Regla 19
        if ($(campo_j).attr('id')=='txt_F4_S1_P41_10')
        {
		suma=0;
        for (i=1;i<31;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_10').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_decimales(campo)+parseFloat(suma);
			}
			campo41_10=$.trim($(campo_j).val())
		if (suma != eliminar_decimales(campo41_10))
                {
					if (perfil == 4)
					{
						if(!confirm('Advertencia: Subtotal (suma de control) % de sobretasa no cuadra.\n ¿Desea continuar?'))
						{
						$('#txt_F4_S1_P1_10').focus();
						$('#txt_F4_S1_P1_10').select();
						return false;
						}
						else
						{
						flag_2 = true;
						$('#txt_F4_S1_P41_11').focus();
						return false;
						}    
					}
					else 
					{
					alert("Error: Subtotal (suma de control) % de sobretasa no cuadra.");
                    $('#txt_F4_S1_P1_10').focus();
                    $('#txt_F4_S1_P1_10').select();
                    return false;
					}
                }
        } 
            //Regla 20
        if ($(campo_j).attr('id')=='txt_F4_S1_P41_11')
        {
		suma=0;
        for (i=1;i<31;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_11').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_decimales(campo)+parseFloat(suma);
			}
			campo41_11=$.trim($(campo_j).val())
		if (suma != eliminar_decimales(campo41_11))
                {
					if (perfil == 4)
					{
						if(!confirm('Advertencia: Subtotal (suma de control) consumo del ejercicio no cuadra.\n ¿Desea continuar?'))
						{
						$('#txt_F4_S1_P1_11').focus();
						$('#txt_F4_S1_P1_11').select();
						return false;
						}
						else
						{
						flag_2 = true;
						$('#txt_F4_S1_P41_12').focus();
						return false;
						}    
					}
					else 
					{
					alert("Error: Subtotal (suma de control) consumo del ejercicio no cuadra.");
                    $('#txt_F4_S1_P1_11').focus();
                    $('#txt_F4_S1_P1_11').select();
                    return false;
					}
                }
        } 
            //Regla 21
        if ($(campo_j).attr('id')=='txt_F4_S1_P41_12')
        {
		suma=0;
        for (i=1;i<31;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_12').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_decimales(campo)+parseFloat(suma);
			}
			campo41_12=$.trim($(campo_j).val())
		if (suma != eliminar_decimales(campo41_12))
                {
					if (perfil == 4)
					{
						if(!confirm('Advertencia: Subtotal (suma de control) stock final no cuadra.\n ¿Desea continuar?'))
						{
						$('#txt_F4_S1_P1_12').focus();
						$('#txt_F4_S1_P1_12').select();
						return false;
						}
						else
						{
						flag_2 = true;
						$('#txt_F4_S1_P41_13').focus();
						return false;
						}    
					}
					else 
					{
					alert("Error: Subtotal (suma de control) stock final no cuadra.");
                    $('#txt_F4_S1_P1_12').focus();
                    $('#txt_F4_S1_P1_12').select();
                    return false;
					}
                }
        } 
        //Regla 22
        if ($(campo_j).attr('id')=='txt_F4_S1_P41_13')
        {
		suma=0;
        for (i=1;i<31;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_13').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_decimales(campo)+parseFloat(suma);
			}
			campo41_13=$.trim($(campo_j).val())
		if (suma != eliminar_decimales(campo41_13))
                {
					if (perfil == 4)
					{
						if(!confirm('Advertencia: Subtotal (suma de control) % importado del total de compras físicas no cuadra.\n ¿Desea continuar?'))
						{
						$('#txt_F4_S1_P1_13').focus();
						$('#txt_F4_S1_P1_13').select();
						return false;
						}
						else
						{
						flag_2 = true;
						$('#txt_F4_S1_P42_5').focus();
						return false;
						}    
					}
					else 
					{
					alert("Error: Subtotal (suma de control) % importado del total de compras físicas no cuadra.");
                    $('#txt_F4_S1_P1_13').focus();
                    $('#txt_F4_S1_P1_13').select();
                    return false;
					}
                }
        } 
        //Regla 23
        if ($(campo_j).attr('id')=='txt_F4_S1_P44_5')
        {
		suma=0;
        for (i=41;i<45;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_5').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_miles(campo)+suma;
			}
			campo44_5=$.trim($(campo_j).val())
		if (suma != eliminar_miles(campo44_5))
                {
					if (perfil == 4)
					{
						if(!confirm('Advertencia: Total de compras, traspasos de materias primas y materiales no cuadra.\n ¿Desea continuar?'))
						{
						$('#txt_F4_S1_P41_5').focus();
						$('#txt_F4_S1_P41_5').select();
						return false;
						}
						else
						{
						flag_2 = true;
						$('#txt_F4_S1_P44_8').focus();
						return false;
						}    
					}
					else 
					{
					alert("Error: Total de compras, traspasos de materias primas y materiales no cuadra.");
                    $('#txt_F4_S1_P41_5').focus();
                    $('#txt_F4_S1_P41_5').select();
                    return false;
					}
                }
        } 
    //Regla 24
        if ($(campo_j).attr('id')=='txt_F4_S1_P44_8')
        {
       	campo42=$.trim($('#txt_F4_S1_P42_8').val());
		campo44=$.trim($(campo_j).val());
		suma=eliminar_decimales(campo44)*0.1;
      	if (eliminar_decimales(campo42) > suma && eliminar_decimales(campo42)>0 )
                {
				if(!confirm('Advertencia: Valor compra otras materias primas no incluidas anteriorrrmente, no puede superar el 10% del total de compras, traspasos de materias primas y materiales.\n ¿Desea continuar?')){
                $(campo_j).focus();
                $(campo_j).select();
                return false;
                }else{
                flag_2 = true;
                $('#txt_F4_S1_P45_8').focus();
                return false;
                }
                }
        } 
        //Regla 25
        if ($(campo_j).attr('id')=='txt_F4_S1_P44_8')
        {
       	campo43=$.trim($('#txt_F4_S1_P43_8').val());
		campo44=$.trim($(campo_j).val());
		suma=eliminar_decimales(campo44)*0.2;
      	if (eliminar_decimales(campo43) > suma && eliminar_decimales(campo43)>0 )
                {
				if(!confirm('Advertencia: Valor compra otros materiales utilizados por el establecimiento y no incluidos anteriormente no puede superar el 20% del total de compras, traspasos de materias primas y materiales.\n ¿Desea continuar?')){
                $(campo_j).focus();
                $(campo_j).select();
                return false;
                }else{
                flag_2 = true;
                $('#txt_F4_S1_P45_8').focus();
                return false;
                }
                }
        } 
         //Regla 26
        if ($(campo_j).attr('id')=='txt_F4_S1_P44_8')
        {
		suma=0;
        for (i=41;i<44;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_8').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_decimales(campo)+parseFloat(suma);
			}
			campo44_8=$.trim($(campo_j).val())
		if (suma != eliminar_decimales(campo44_8))
                {
					if (perfil == 4)
					{
						if(!confirm('Advertencia: Total de compras traspasos de materias primas y materiales, valor compra en moneda utilizada no cuadra.\n ¿Desea continuar?'))
						{
						$('#txt_F4_S1_P41_8').focus();
						$('#txt_F4_S1_P41_8').select();
						return false;
						}
						else
						{
						flag_2 = true;
						$('#txt_F4_S1_P44_9').focus();
						return false;
						}    
					}
					else 
					{
					alert("Error: Total de compras traspasos de materias primas y materiales, valor compra en moneda utilizada no cuadra.");
                    $('#txt_F4_S1_P41_8').focus();
                    $('#txt_F4_S1_P41_8').select();
                    return false;
					}
                }
        } 
        //Regla 27
        if ($(campo_j).attr('id')=='txt_F4_S1_P44_5')
        {
		suma=0;
        for (i=41;i<44;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_5').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_miles(campo)+suma;
			}
			campo44_5=$.trim($(campo_j).val())
		if (suma != eliminar_miles(campo44_5))
                {
					if (perfil == 4)
					{
						if(!confirm('Advertencia: Total de compras traspasos de materias primas y materiales, valor traspaso en moneda utilizada no cuadra.\n ¿Desea continuar?'))
						{
						$('#txt_F4_S1_P41_5').focus();
						$('#txt_F4_S1_P41_5').select();
						return false;
						}
						else
						{
						flag_2 = true;
						$('#txt_F4_S1_P44_8').focus();
						return false;
						}    
					}
					else 
					{
					alert("Error: Total de compras traspasos de materias primas y materiales, valor traspaso en moneda utilizada no cuadra.");
                    $('#txt_F4_S1_P41_5').focus();
                    $('#txt_F4_S1_P41_5').select();
                    return false;
					}
                }
        } 
         //Regla 28
        if ($(campo_j).attr('id')=='txt_F4_S1_P44_9')
        {
		suma=0;
        for (i=41;i<44;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_9').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_miles(campo)+suma;
			}
			campo44_9=$.trim($(campo_j).val())
		if (suma != eliminar_miles(campo44_9))
                {
					if (perfil == 4)
					{
						if(!confirm('Advertencia: Total de compras traspasos de materias primas y materiales, I.V.A. no cuadra.\n ¿Desea continuar?'))
						{
						$('#txt_F4_S1_P41_9').focus();
						$('#txt_F4_S1_P41_9').select();
						return false;
						}
						else
						{
						flag_2 = true;
						$('#txt_F4_S1_P44_10').focus();
						return false;
						}    
					}
					else 
					{
					alert("Error: Total de compras traspasos de materias primas y materiales, I.V.A. no cuadra.");
                    $('#txt_F4_S1_P41_9').focus();
                    $('#txt_F4_S1_P41_9').select();
                    return false;
					}
                }
        } 
         //Regla 29
        if ($(campo_j).attr('id')=='txt_F4_S1_P44_10')
        {
		suma=0;
        for (i=41;i<44;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_10').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_decimales(campo)+parseFloat(suma);
			}
			campo44_10=$.trim($(campo_j).val())
		if (suma != eliminar_decimales(campo44_10))
                {
					if (perfil == 4)
					{
						if(!confirm('Advertencia: Total de compras traspasos de materias primas y materiales,% sobretasa no cuadra.\n ¿Desea continuar?'))
						{
						$('#txt_F4_S1_P41_10').focus();
						$('#txt_F4_S1_P41_10').select();
						return false;
						}
						else
						{
						flag_2 = true;
						$('#txt_F4_S1_P45_5').focus();
						return false;
						}    
					}
					else 
					{
					alert("Error: Total de compras traspasos de materias primas y materiales,% sobretasa no cuadra.");
                    $('#txt_F4_S1_P41_10').focus();
                    $('#txt_F4_S1_P41_10').select();
                    return false;
					}
                }
        } 
        //Regla 30
        if ($(campo_j).attr('id')=='txt_F4_S1_P46_5')
        {
		suma=0;
        for (i=44;i<46;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_5').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_miles(campo)+suma;
			}
			campo46_5=$.trim($(campo_j).val())
		if (suma != eliminar_miles(campo46_5))
                {
					if (perfil == 4)
					{
						if(!confirm('Advertencia: Total de control, valor traspaso en moneda utilizada no cuadra.\n ¿Desea continuar?'))
						{
						$('#txt_F4_S1_P41_5').focus();
						$('#txt_F4_S1_P41_5').select();
						return false;
						}
						else
						{
						flag_2 = true;
						$('#txt_F4_S1_P46_8').focus();
						return false;
						}    
					}
					else 
					{
					alert("Error: Total de control, valor traspaso en moneda utilizada no cuadra.");
                    $('#txt_F4_S1_P41_5').focus();
                    $('#txt_F4_S1_P41_5').select();
                    return false;
					}
                }
        } 
         //Regla 31
        if ($(campo_j).attr('id')=='txt_F4_S1_P46_8')
        {
		suma=0;
        for (i=44;i<46;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_8').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_decimales(campo)+parseFloat(suma);
			}
			campo46_8=$.trim($(campo_j).val())
		if (suma != eliminar_decimales(campo46_8))
                {
					if (perfil == 4)
					{
						if(!confirm('Advertencia: Total de control, valor compra en moneda utilizada no cuadra.\n ¿Desea continuar?'))
						{
						$('#txt_F4_S1_P41_8').focus();
						$('#txt_F4_S1_P41_8').select();
						return false;
						}
						else
						{
						flag_2 = true;
						$('#txt_F4_S1_P46_8').focus();
						return false;
						}    
					}
					else 
					{
					alert("Error: Total de control, valor compra en moneda utilizada no cuadra.");
                    $('#txt_F4_S1_P44_8').focus();
                    $('#txt_F4_S1_P44_8').select();
                    return false;
					}
                }
        } 
         //Regla 32
        if ($(campo_j).attr('id')=='txt_F4_S1_P46_9')
        {
		suma=0;
        for (i=44;i<46;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_9').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_miles(campo)+suma;
			}
			campo46_9=$.trim($(campo_j).val())
		if (suma != eliminar_miles(campo46_9))
                {
					if (perfil == 4)
					{
						if(!confirm('Advertencia: Total de control, I.V.A. no cuadra.\n ¿Desea continuar?'))
						{
						$('#txt_F4_S1_P41_9').focus();
						$('#txt_F4_S1_P41_9').select();
						return false;
						}
						else
						{
						flag_2 = true;
						$('#txt_F4_S1_P46_10').focus();
						return false;
						}    
					}
					else 
					{
					alert("Error: Total de control, I.V.A. no cuadra.");
                    $('#txt_F4_S1_P44_9').focus();
                    $('#txt_F4_S1_P44_9').select();
                    return false;
					}
                }
        }
         //Regla 33
        if ($(campo_j).attr('id')=='txt_F4_S1_P46_10')
        {
		suma=0;
        for (i=44;i<46;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_10').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_decimales(campo)+parseFloat(suma);
			}
			campo46_10=$.trim($(campo_j).val())
		if (suma != eliminar_decimales(campo46_10))
                {
					if (perfil == 4)
					{
						if(!confirm('Advertencia: Total de control, % de sobretasa no cuadra.\n ¿Desea continuar?'))
						{
						$('#txt_F4_S1_P41_10').focus();
						$('#txt_F4_S1_P41_10').select();
						return false;
						}
						else
						{
						flag_2 = true;
						$('#txt_F4_S1_PNombreEncardadoProduccion').focus();
						return false;
						}    
					}
					else 
					{
					alert("Error: Total de control, % de sobretasa no cuadra.");
                    $('#txt_F4_S1_P44_10').focus();
                    $('#txt_F4_S1_P44_10').select();
                    return false;
					}
                }
        }  
     return true;
}
function validar_todo(){
    error = 0;
    advertencia = 0;
    var cont=-1;
    var foco = new Array();
	mensaje="\n";
	var col=1;
	var e=1;
    $.each($('input'),function(i,v){
        campo_j = "#"+$(this).attr('id');
        //Regla del 1 al 12
	//LINEA 1

	if (col==13)
        {
        e++;
        col=1;
        }
		
    //Regla 1
        if ($(campo_j).attr('id')=='txt_F4_S1_P'+e+'_13')
        {
        campo04=$.trim($('#txt_F4_S1_P'+e+'_4').val());
        campo05=$.trim($('#txt_F4_S1_P'+e+'_5').val());
        campo06=$.trim($('#txt_F4_S1_P'+e+'_6').val());
        campo07=$.trim($('#txt_F4_S1_P'+e+'_7').val());
        campo08=$.trim($('#txt_F4_S1_P'+e+'_8').val());
        campo09=$.trim($('#txt_F4_S1_P'+e+'_9').val());
        campo10=$.trim($('#txt_F4_S1_P'+e+'_10').val());
        campo11=$.trim($('#txt_F4_S1_P'+e+'_11').val());
        campo12=$.trim($('#txt_F4_S1_P'+e+'_12').val());
        campo13=$.trim($('#txt_F4_S1_P'+e+'_13').val());
        suma1=eliminar_miles(campo05)+eliminar_miles(campo09);
        suma2=eliminar_decimales(campo04)+eliminar_decimales(campo06)+eliminar_decimales(campo07)+eliminar_miles(campo08)+eliminar_decimales(campo10)+eliminar_decimales(campo11)+eliminar_decimales(campo12)+eliminar_decimales(campo13);
        total=parseFloat(suma1)+parseFloat(suma2);
        if ($.trim($('#txt_F4_S1_P'+e+'_2').val()).length  == 0 && total > 0)
		    {
					if (perfil == 4)
					{
					mensaje=mensaje +("Campo Fila "+e+" - Advertencia: No informa nombre detallado del producto. \n");
					$(campo_j).css('border','2px solid #FFA500');
					advertencia++;
					foco[++cont] = campo_j;
					}
					else
					{
					mensaje=mensaje +("Campo Fila "+e+" - Error: No informa nombre detallado del producto. \n");
                    $(campo_j).css('border','2px solid red');
			        error++;
			        foco[++cont] = campo_j;
					}							
		    }
        }
        
        //Regla 3
        if ($(campo_j).attr('id')=='txt_F4_S1_P'+e+'_5')
        {
        campo04=$.trim($('#txt_F4_S1_P'+e+'_4').val());
        campo05=$.trim($('#txt_F4_S1_P'+e+'_5').val());
        if ( eliminar_decimales(campo04) == 0 && eliminar_miles(campo05)>0 )
		    {
					if (perfil == 4)
					{
					mensaje=mensaje +("Campo Fila "+e+" - Advertencia: Informa valor pero no cantidad traspasada. \n");
					$(campo_j).css('border','2px solid #FFA500');
					advertencia++;
					foco[++cont] = campo_j;
					}
					else
					{
					mensaje=mensaje +("Campo Fila "+e+" - Error: Informa valor pero no cantidad traspasada. \n");
                    $(campo_j).css('border','2px solid red');
			        error++;
			        foco[++cont] = campo_j;
					}										
		    }
        } 
        		//Regla 4
        if ($(campo_j).attr('id')=='txt_F4_S1_P'+e+'_5')
        {
        campo04=$.trim($('#txt_F4_S1_P'+e+'_4').val());
        campo05=$.trim($('#txt_F4_S1_P'+e+'_5').val());
        if ( eliminar_decimales(campo04) > 0 && eliminar_miles(campo05)==0 )
		    {
					if (perfil == 4)
					{
					mensaje=mensaje +("Campo Fila "+e+" - Advertencia: Informa cantidad pero no valor de traspaso. \n");
					$(campo_j).css('border','2px solid #FFA500');
					advertencia++;
					foco[++cont] = campo_j;
					}
					else
					{
					mensaje=mensaje +("Campo Fila "+e+" - Error: Informa cantidad pero no valor de traspaso. \n");
                    $(campo_j).css('border','2px solid red');
			        error++;
			        foco[++cont] = campo_j;
					}										
			}
        } 
 		//Regla 5
        if ($(campo_j).attr('id')=='txt_F4_S1_P'+e+'_7')
        {
        campo07=$.trim($('#txt_F4_S1_P'+e+'_7').val());
        if ($.trim($('#txt_F4_S1_P'+e+'_2').val()).length  != 0 && eliminar_decimales(campo07) == 0 )
		    {
					mensaje=mensaje +("Campo Fila "+e+" - Advertencia: Informa materia prima pero no indica cantidad comprada. \n");
                    $(campo_j).css('border','2px solid #FFA500');
					advertencia++;
					foco[++cont] = campo_j;
										
		    }
        } 
        //Regla 6
        if ($(campo_j).attr('id')=='txt_F4_S1_P'+e+'_8')
        {
        campo07=$.trim($('#txt_F4_S1_P'+e+'_7').val());
        campo08=$.trim($('#txt_F4_S1_P'+e+'_8').val());
        if ( eliminar_decimales(campo07) > 0 && eliminar_miles(campo08)==0 )
		    {
					if (perfil == 4)
					{
					mensaje=mensaje +("Campo Fila "+e+" - Advertencia: Informa cantidad comprada pero no valor de la compra. \n");
					$(campo_j).css('border','2px solid #FFA500');
					advertencia++;
					foco[++cont] = campo_j;
					}
					else
					{
					mensaje=mensaje +("Campo Fila "+e+" - Error: Informa cantidad comprada pero no valor de la compra. \n");
                    $(campo_j).css('border','2px solid red');
			        error++;
			        foco[++cont] = campo_j;
					}										
		    }
        }  
        //Regla 7
        if ($(campo_j).attr('id')=='txt_F4_S1_P'+e+'_8')
        {
        campo07=$.trim($('#txt_F4_S1_P'+e+'_8').val());
        if ($.trim($('#txt_F4_S1_P'+e+'_2').val()).length  != 0 && eliminar_miles(campo08) == 0 )
		    {
					mensaje=mensaje +("Campo Fila "+e+" - Advertencia: Informa materia prima pero valor de compra es cero. \n");
                    $(campo_j).css('border','2px solid #FFA500');
					advertencia++;
					foco[++cont] = campo_j;
		    }
        } 
        //Regla 8
        if ($(campo_j).attr('id')=='txt_F4_S1_P'+e+'_8')
        {
        campo07=$.trim($('#txt_F4_S1_P'+e+'_7').val());
        campo08=$.trim($('#txt_F4_S1_P'+e+'_8').val());
        if ( eliminar_decimales(campo07)== 0 && eliminar_miles(campo08)>0 )
		    {   
					if (perfil == 4)
					{
					mensaje=mensaje +("Campo Fila "+e+" - Advertencia: Informa valor pero no cantidad comprada. \n");
					$(campo_j).css('border','2px solid #FFA500');
					advertencia++;
					foco[++cont] = campo_j;
					}
					else
					{
					mensaje=mensaje +("Campo Fila "+e+" - Error: Informa valor pero no cantidad comprada. \n");
                    $(campo_j).css('border','2px solid red');
			        error++;
			        foco[++cont] = campo_j;
					}										
							
		    }
        }   
        //Regla 9
        if ($(campo_j).attr('id')=='txt_F4_S1_P'+e+'_12')
        {
        campo04=$.trim($('#txt_F4_S1_P'+e+'_4').val());
		campo06=$.trim($('#txt_F4_S1_P'+e+'_6').val());
		campo07=$.trim($('#txt_F4_S1_P'+e+'_7').val());
		campo12=$.trim($('#txt_F4_S1_P'+e+'_12').val());
		campo11=$.trim($('#txt_F4_S1_P'+e+'_11').val());
		suma=eliminar_decimales(campo04)+eliminar_decimales(campo06)-eliminar_decimales(campo07)-eliminar_decimales(campo12);
        if (eliminar_decimales(campo11) != suma)
		    {
					mensaje=mensaje +("Campo Fila "+e+" - Advertencia: Consumo del ejercicio inconsistente. \n");
                    $(campo_j).css('border','2px solid #FFA500');
					advertencia++;
					foco[++cont] = campo_j;
		    }
        }
        //Regla 10
        if ($(campo_j).attr('id')=='txt_F4_S1_P'+e+'_9')
        {
        campo08=$.trim($('#txt_F4_S1_P'+e+'_8').val());
        campo09=$.trim($('#txt_F4_S1_P'+e+'_9').val());
        if ( eliminar_decimales(campo08) > 0 && eliminar_miles(campo09)==0 )
		    {
					if (perfil == 4)
					{
					mensaje=mensaje +("Campo Fila "+e+" - Advertencia: Informa valor de compra de materias primas y materiales, pero no el I.V.A. \n");
					$(campo_j).css('border','2px solid #FFA500');
					advertencia++;
					foco[++cont] = campo_j;
					}
					else
					{
					mensaje=mensaje +("Campo Fila "+e+" - Error: Informa valor de compra de materias primas y materiales, pero no el I.V.A. \n");
                    $(campo_j).css('border','2px solid red');
			        error++;
			        foco[++cont] = campo_j;
					}										
		    }
        } 
        //Regla 11
        if ($(campo_j).attr('id')=='txt_F4_S1_P'+e+'_13')
        {
        campo13=$.trim($('#txt_F4_S1_P'+e+'_13').val());
        if ( eliminar_decimales(campo13) < 0 || eliminar_decimales(campo13)>100 )
		    {
					if (perfil == 4)
					{
					mensaje=mensaje +("Campo Fila "+e+" - Advertencia: % de importaciones fuera de rango (0-100%). \n");
					$(campo_j).css('border','2px solid #FFA500');
					advertencia++;
					foco[++cont] = campo_j;
					}
					else
					{
					mensaje=mensaje +("Campo Fila "+e+" - Error: % de importaciones fuera de rango (0-100%). \n");
                    $(campo_j).css('border','2px solid red');
			        error++;
			        foco[++cont] = campo_j;
					}										
							
		    }
        } 
        //Regla 12
        if ($(campo_j).attr('id')=='txt_F4_S1_P'+e+'_10')
        {
        campo10=$.trim($('#txt_F4_S1_P'+e+'_10').val());
        if ( eliminar_decimales(campo10) < 0 || eliminar_decimales(campo10)>100 )
		    {
					if (perfil == 4)
					{
					mensaje=mensaje +("Campo Fila "+e+" - Advertencia: % de sobretasa fuera de rango (0-100%). \n");
					$(campo_j).css('border','2px solid #FFA500');
					advertencia++;
					foco[++cont] = campo_j;
					}
					else
					{
					mensaje=mensaje +("Campo Fila "+e+" - Error: % de sobretasa fuera de rango (0-100%). \n");
                    $(campo_j).css('border','2px solid red');
			        error++;
			        foco[++cont] = campo_j;
					}										
							
		    }
        } 
       // contador de controles de pagina descartando 3 elementos
       if (campo_j.toString() != '#__VIEWSTATE' || campo_j.toString() != '#__EVENTVALIDATION' || campo_j.toString() !='#TextBox1' ||
       campo_j.toString() != '#__EVENTARGUMENT' || campo_j.toString() != '#__EVENTTARGET' || campo_j.toString() != '#__LASTFOCUS')
        {
        col++ ;
        }
        //Regla 13
        if ($(campo_j).attr('id')=='txt_F4_S1_P41_4')
        {
        suma=0;
        for (i=1;i<31;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_4').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_decimales(campo)+parseFloat(suma);
			}
			campo41_4=$.trim($(campo_j).val())
		if (suma != eliminar_decimales(campo41_4))
                {
					if (perfil == 4)
					{
					mensaje=mensaje +("Campo Fila 41, Columna 4 - Advertencia: Subtotal (suma de control) cantidad traspasada no cuadra. \n");
					$(campo_j).css('border','2px solid #FFA500');
					advertencia++;
					foco[++cont] = campo_j;
					}
					else
					{
					mensaje=mensaje +("Campo Fila 41, Columna 4 - Error: Subtotal (suma de control) cantidad traspasada no cuadra. \n");
                    $(campo_j).css('border','2px solid red');
			        error++;
			        foco[++cont] = campo_j;
					}
                }
        } 
		  //Regla 14
        if ($(campo_j).attr('id')=='txt_F4_S1_P41_5')
        {
        suma=0;
        for (i=1;i<31;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_5').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_miles(campo)+suma;
			}
			campo41_5=$.trim($(campo_j).val())
		if (suma != eliminar_miles(campo41_5))
                {
					if (perfil == 4)
					{
					mensaje=mensaje +("Campo Fila 41, Columna 5 - Advertencia: Subtotal (suma de control) valor traspaso no cuadra. \n");
					$(campo_j).css('border','2px solid #FFA500');
					advertencia++;
					foco[++cont] = campo_j;
					}
					else
					{
					mensaje=mensaje +("Campo Fila 41, Columna 5 - Error: Subtotal (suma de control) valor traspaso no cuadra. \n");
                    $(campo_j).css('border','2px solid red');
			        error++;
			        foco[++cont] = campo_j;
					}
                }
        } 
            //Regla 15
        if ($(campo_j).attr('id')=='txt_F4_S1_P41_6')
        {
        suma=0;
        for (i=1;i<31;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_6').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_decimales(campo)+parseFloat(suma);
			}
			campo41_6=$.trim($(campo_j).val())
		if (suma != eliminar_decimales(campo41_6))
                {
					if (perfil == 4)
					{
					mensaje=mensaje +("Campo Fila 41, Columna 6 - Advertencia: Subtotal (suma de control) stock inicial no cuadra. \n");
					$(campo_j).css('border','2px solid #FFA500');
					advertencia++;
					foco[++cont] = campo_j;
					}
					else
					{
					mensaje=mensaje +("Campo Fila 41, Columna 6 - Error: Subtotal (suma de control) stock inicial no cuadra. \n");
                    $(campo_j).css('border','2px solid red');
			        error++;
			        foco[++cont] = campo_j;
					}
                }
        } 
            //Regla 16
        if ($(campo_j).attr('id')=='txt_F4_S1_P41_7')
        {
		suma=0;
        for (i=1;i<31;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_7').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_decimales(campo)+parseFloat(suma);
			}
			campo41_7=$.trim($(campo_j).val())
		if (suma != eliminar_decimales(campo41_7))
                {
					if (perfil == 4)
					{
					mensaje=mensaje +("Campo Fila 41, Columna 7 - Advertencia: Subtotal (suma de control) cantidad comprada no cuadra. \n");
					$(campo_j).css('border','2px solid #FFA500');
					advertencia++;
					foco[++cont] = campo_j;
					}
					else
					{
					mensaje=mensaje +("Campo Fila 41, Columna 7 - Error: Subtotal (suma de control) cantidad comprada no cuadra. \n");
                    $(campo_j).css('border','2px solid red');
			        error++;
			        foco[++cont] = campo_j;
					}
                }
        } 
            //Regla 17
        if ($(campo_j).attr('id')=='txt_F4_S1_P41_8')
        {
		suma=0;
        for (i=1;i<31;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_8').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_decimales(campo)+parseFloat(suma);
			}
			campo41_8=$.trim($(campo_j).val())
		if (suma != eliminar_decimales(campo41_8))
                {
					if (perfil == 4)
					{
					mensaje=mensaje +("Campo Fila 41, Columna 8 - Advertencia: Subtotal (suma de control) valor valor compra en moneda utilizada no cuadra. \n");
					$(campo_j).css('border','2px solid #FFA500');
					advertencia++;
					foco[++cont] = campo_j;
					}
					else
					{
					mensaje=mensaje +("Campo Fila 41, Columna 8 - Error: Subtotal (suma de control) valor valor compra en moneda utilizada no cuadra. \n");
                    $(campo_j).css('border','2px solid red');
			        error++;
			        foco[++cont] = campo_j;
					}
                }
        } 
            //Regla 18
        if ($(campo_j).attr('id')=='txt_F4_S1_P41_9')
        {
		suma=0;
        for (i=1;i<31;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_9').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_miles(campo)+suma;
			}
			campo41_9=$.trim($(campo_j).val())
		if (suma != eliminar_miles(campo41_9))
                {
					if (perfil == 4)
					{
					mensaje=mensaje +("Campo Fila 41, Columna 9 - Advertencia: Subtotal (suma de control) I.V.A. no cuadra. \n");
					$(campo_j).css('border','2px solid #FFA500');
					advertencia++;
					foco[++cont] = campo_j;
					}
					else
					{
					mensaje=mensaje +("Campo Fila 41, Columna 9 - Error: Subtotal (suma de control) I.V.A. no cuadra. \n");
                    $(campo_j).css('border','2px solid red');
			        error++;
			        foco[++cont] = campo_j;
					}
                }
        } 
            //Regla 19
        if ($(campo_j).attr('id')=='txt_F4_S1_P41_10')
        {
		suma=0;
        for (i=1;i<31;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_10').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_decimales(campo)+parseFloat(suma);
			}
			campo41_10=$.trim($(campo_j).val())
		if (suma != eliminar_decimales(campo41_10))
                {
					if (perfil == 4)
					{
					mensaje=mensaje +("Campo Fila 41, Columna 10 - Advertencia: Subtotal (suma de control) % de sobretasa no cuadra. \n");
					$(campo_j).css('border','2px solid #FFA500');
					advertencia++;
					foco[++cont] = campo_j;
					}
					else
					{
					mensaje=mensaje +("Campo Fila 41, Columna 10 - Error: Subtotal (suma de control) % de sobretasa no cuadra. \n");
                    $(campo_j).css('border','2px solid red');
			        error++;
			        foco[++cont] = campo_j;
					}
                }
        } 
            //Regla 20
        if ($(campo_j).attr('id')=='txt_F4_S1_P41_11')
        {
		suma=0;
        for (i=1;i<31;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_11').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_decimales(campo)+parseFloat(suma);
			}
			campo41_11=$.trim($(campo_j).val())
		if (suma != eliminar_decimales(campo41_11))
                {
					if (perfil == 4)
					{
					mensaje=mensaje +("Campo Fila 41, Columna 11 - Advertencia: Subtotal (suma de control) consumo del ejercicio no cuadra. \n");
					$(campo_j).css('border','2px solid #FFA500');
					advertencia++;
					foco[++cont] = campo_j;
					}
					else
					{
					mensaje=mensaje +("Campo Fila 41, Columna 11 - Error: Subtotal (suma de control) consumo del ejercicio no cuadra. \n");
                    $(campo_j).css('border','2px solid red');
			        error++;
			        foco[++cont] = campo_j;
					}
                }
        } 
            //Regla 21
        if ($(campo_j).attr('id')=='txt_F4_S1_P41_12')
        {
		suma=0;
        for (i=1;i<31;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_12').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_decimales(campo)+parseFloat(suma);
			}
			campo41_12=$.trim($(campo_j).val())
		if (suma != eliminar_decimales(campo41_12))
                {
					if (perfil == 4)
					{
					mensaje=mensaje +("Campo Fila 41, Columna 12 - Advertencia: Subtotal (suma de control) stock final no cuadra. \n");
					$(campo_j).css('border','2px solid #FFA500');
					advertencia++;
					foco[++cont] = campo_j;
					}
					else
					{
					mensaje=mensaje +("Campo Fila 41, Columna 12 - Error: Subtotal (suma de control) stock final no cuadra. \n");
                    $(campo_j).css('border','2px solid red');
			        error++;
			        foco[++cont] = campo_j;
					}
                }
        } 
        //Regla 22
        if ($(campo_j).attr('id')=='txt_F4_S1_P41_13')
        {
		suma=0;
        for (i=1;i<31;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_13').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_decimales(campo)+parseFloat(suma);
			}
			campo41_13=$.trim($(campo_j).val())
		if (suma != eliminar_decimales(campo41_13))
                {
					if (perfil == 4)
					{
					mensaje=mensaje +("Campo Fila 41, Columna 13 - Advertencia: Subtotal (suma de control) % importado del total de compras físicas no cuadra. \n");
					$(campo_j).css('border','2px solid #FFA500');
					advertencia++;
					foco[++cont] = campo_j;
					}
					else
					{
					mensaje=mensaje +("Campo Fila 41, Columna 13 - Error: Subtotal (suma de control) % importado del total de compras físicas no cuadra. \n");
                    $(campo_j).css('border','2px solid red');
			        error++;
			        foco[++cont] = campo_j;
					}
                }
        } 
        //Regla 23
        if ($(campo_j).attr('id')=='txt_F4_S1_P44_5')
        {
		suma=0;
        for (i=41;i<45;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_5').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_miles(campo)+suma;
			}
			campo44_5=$.trim($(campo_j).val())
		if (suma != eliminar_miles(campo44_5))
                {
					if (perfil == 4)
					{
					mensaje=mensaje +("Campo Fila 44, Columna 5 - Advertencia: Total de compras, traspasos de materias primas y materiales no cuadra. \n");
					$(campo_j).css('border','2px solid #FFA500');
					advertencia++;
					foco[++cont] = campo_j;
					}
					else
					{
					mensaje=mensaje +("Campo Fila 44, Columna 5 - Error: Total de compras, traspasos de materias primas y materiales no cuadra. \n");
                    $(campo_j).css('border','2px solid red');
			        error++;
			        foco[++cont] = campo_j;
					}
                }
        } 
    //Regla 24
        if ($(campo_j).attr('id')=='txt_F4_S1_P44_8')
        {
       	campo42=$.trim($('#txt_F4_S1_P42_8').val());
		campo44=$.trim($(campo_j).val());
		suma=eliminar_decimales(campo44)*0.1;
      	if (eliminar_decimales(campo42) > suma && eliminar_decimales(campo42)>0 )
                {
					if (perfil == 4)
					{
					mensaje=mensaje +("Campo Fila 42, Columna 5 - Advertencia: Valor compra otras materias primas no incluidas anteriorrrmente, no puede superar el 10% del total de compras, traspasos de materias primas y materiales. \n");
					$(campo_j).css('border','2px solid #FFA500');
					advertencia++;
					foco[++cont] = campo_j;
					}
					else
					{
					mensaje=mensaje +("Campo Fila 42, Columna 5 - Error: Valor compra otras materias primas no incluidas anteriorrrmente, no puede superar el 10% del total de compras, traspasos de materias primas y materiales. \n");
                    $(campo_j).css('border','2px solid red');
			        advertencia++;
			        foco[++cont] = campo_j;
					}
              }
        } 
        //Regla 25
        if ($(campo_j).attr('id')=='txt_F4_S1_P44_8')
        {
       	campo43=$.trim($('#txt_F4_S1_P43_8').val());
		campo44=$.trim($(campo_j).val());
		suma=eliminar_decimales(campo44)*0.2;
      	if (eliminar_decimales(campo43) > suma && eliminar_decimales(campo43)>0 )
                {	
					if (perfil == 4)
					{
					mensaje=mensaje +("Campo Fila 43, Columna 8 - Advertencia: Valor compra otros materiales utilizados por el establecimiento y no incluidos anteriormente no puede superar el 20% del total de compras, traspasos de materias primas y materiales. \n");
					$(campo_j).css('border','2px solid #FFA500');
					advertencia++;
					foco[++cont] = campo_j;
					}
					else
					{
					mensaje=mensaje +("Campo Fila 43, Columna 8 - Error: Valor compra otros materiales utilizados por el establecimiento y no incluidos anteriormente no puede superar el 20% del total de compras, traspasos de materias primas y materiales. \n");
                    $(campo_j).css('border','2px solid red');
			        advertencia++;
			        foco[++cont] = campo_j;
					}
               }
        } 
         //Regla 26
        if ($(campo_j).attr('id')=='txt_F4_S1_P44_8')
        {
		suma=0;
        for (i=41;i<44;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_8').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_decimales(campo)+parseFloat(suma);
			}
			campo44_8=$.trim($(campo_j).val())
		if (suma != eliminar_decimales(campo44_8))
                {
					if (perfil == 4)
					{
					mensaje=mensaje +("Campo Fila 44, Columna 8 - Advertencia: Total de compras traspasos de materias primas y materiales, valor compra en moneda utilizada no cuadra. \n");
					$(campo_j).css('border','2px solid #FFA500');
					advertencia++;
					foco[++cont] = campo_j;
					}
					else
					{
					mensaje=mensaje +("Campo Fila 44, Columna 8 - Error: Total de compras traspasos de materias primas y materiales, valor compra en moneda utilizada no cuadra. \n");
                    $(campo_j).css('border','2px solid red');
			        error++;
			        foco[++cont] = campo_j;
					}
                }
        } 
        //Regla 27
        if ($(campo_j).attr('id')=='txt_F4_S1_P44_5')
        {
		suma=0;
        for (i=41;i<44;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_5').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_miles(campo)+suma;
			}
			campo44_5=$.trim($(campo_j).val())
		if (suma != eliminar_miles(campo44_5))
                {
					if (perfil == 4)
					{
					mensaje=mensaje +("Campo Fila 44, Columna 5 - Advertencia: Total de compras traspasos de materias primas y materiales, valor traspaso en moneda utilizada no cuadra. \n");
					$(campo_j).css('border','2px solid #FFA500');
					advertencia++;
					foco[++cont] = campo_j;
					}
					else
					{
					mensaje=mensaje +("Campo Fila 44, Columna 5 - Error: Total de compras traspasos de materias primas y materiales, valor traspaso en moneda utilizada no cuadra. \n");
                    $(campo_j).css('border','2px solid red');
			        error++;
			        foco[++cont] = campo_j;
					}
                }
        } 
         //Regla 28
        if ($(campo_j).attr('id')=='txt_F4_S1_P44_9')
        {
		suma=0;
        for (i=41;i<44;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_9').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_miles(campo)+suma;
			}
			campo44_9=$.trim($(campo_j).val())
		if (suma != eliminar_miles(campo44_9))
                {
					if (perfil == 4)
					{
					mensaje=mensaje +("Campo Fila 44, Columna 9 - Advertencia: Total de compras traspasos de materias primas y materiales, I.V.A. no cuadra. \n");
					$(campo_j).css('border','2px solid #FFA500');
					advertencia++;
					foco[++cont] = campo_j;
					}
					else
					{
					mensaje=mensaje +("Campo Fila 44, Columna 9 - Error: Total de compras traspasos de materias primas y materiales, I.V.A. no cuadra. \n");
                    $(campo_j).css('border','2px solid red');
			        error++;
			        foco[++cont] = campo_j;
					}
                }
        } 
         //Regla 29
        if ($(campo_j).attr('id')=='txt_F4_S1_P44_10')
        {
		suma=0;
        for (i=41;i<44;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_10').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_decimales(campo)+parseFloat(suma);
			}
			campo44_10=$.trim($(campo_j).val())
		if (suma != eliminar_decimales(campo44_10))
                {
					if (perfil == 4)
					{
					mensaje=mensaje +("Campo Fila 44, Columna 10 - Advertencia: Total de compras traspasos de materias primas y materiales,% sobretasa no cuadra. \n");
					$(campo_j).css('border','2px solid #FFA500');
					advertencia++;
					foco[++cont] = campo_j;
					}
					else
					{
					mensaje=mensaje +("Campo Fila 44, Columna 10 - Error: Total de compras traspasos de materias primas y materiales,% sobretasa no cuadra. \n");
                    $(campo_j).css('border','2px solid red');
			        error++;
			        foco[++cont] = campo_j;
					}
                }
        } 
        //Regla 30
        if ($(campo_j).attr('id')=='txt_F4_S1_P46_5')
        {
		suma=0;
        for (i=44;i<46;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_5').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_miles(campo)+suma;
			}
			campo46_5=$.trim($(campo_j).val())
		if (suma != eliminar_miles(campo46_5))
                {
					if (perfil == 4)
					{
					mensaje=mensaje +("Campo Fila 46, Columna 5 - Advertencia: Total de control, valor traspaso en moneda utilizada no cuadra. \n");
					$(campo_j).css('border','2px solid #FFA500');
					advertencia++;
					foco[++cont] = campo_j;
					}
					else
					{
					mensaje=mensaje +("Campo Fila 46, Columna 5 - Error: Total de control, valor traspaso en moneda utilizada no cuadra. \n");
                    $(campo_j).css('border','2px solid red');
			        error++;
			        foco[++cont] = campo_j;
					}
                }
        } 
         //Regla 31
        if ($(campo_j).attr('id')=='txt_F4_S1_P46_8')
        {
		suma=0;
        for (i=44;i<46;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_8').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_decimales(campo)+parseFloat(suma);
			}
			campo46_8=$.trim($(campo_j).val())
		if (suma != eliminar_decimales(campo46_8))
                {
					if (perfil == 4)
					{
					mensaje=mensaje +("Campo Fila 46, Columna 8 - Advertencia: Total de control, valor compra en moneda utilizada no cuadra. \n");
					$(campo_j).css('border','2px solid #FFA500');
					advertencia++;
					foco[++cont] = campo_j;
					}
					else
					{
					mensaje=mensaje +("Campo Fila 46, Columna 8 - Error: Total de control, valor compra en moneda utilizada no cuadra. \n");
                    $(campo_j).css('border','2px solid red');
			        error++;
			        foco[++cont] = campo_j;
					}
                }
        } 
         //Regla 32
        if ($(campo_j).attr('id')=='txt_F4_S1_P46_9')
        {
		suma=0;
        for (i=44;i<46;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_9').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_miles(campo)+suma;
			}
			campo46_9=$.trim($(campo_j).val())
		if (suma != eliminar_miles(campo46_9))
                {
					if (perfil == 4)
					{
					mensaje=mensaje +("Campo Fila 46, Columna 9 - Advertencia: Total de control, I.V.A. no cuadra. \n");
					$(campo_j).css('border','2px solid #FFA500');
					advertencia++;
					foco[++cont] = campo_j;
					}
					else
					{
					mensaje=mensaje +("Campo Fila 46, Columna 9 - Error: Total de control, I.V.A. no cuadra. \n");
                    $(campo_j).css('border','2px solid red');
			        error++;
			        foco[++cont] = campo_j;
					}
                }
        }
         //Regla 33
        if ($(campo_j).attr('id')=='txt_F4_S1_P46_10')
        {
		suma=0;
        for (i=44;i<46;i++)
			{
			campo=$.trim($('#txt_F4_S1_P'+i+'_10').val());
				if (campo=="")
				{
					campo=0;
				}
			
			suma=eliminar_decimales(campo)+parseFloat(suma);
			}
			campo46_10=$.trim($(campo_j).val())
		if (suma != eliminar_decimales(campo46_10))
                {
					if (perfil == 4)
					{
					mensaje=mensaje +("Campo Fila 46, Columna 10 - Advertencia: Total de control, % de sobretasa no cuadra. \n");
					$(campo_j).css('border','2px solid #FFA500');
					advertencia++;
					foco[++cont] = campo_j;
					}
					else
					{
					mensaje=mensaje +("Campo Fila 46, Columna 10 - Error: Total de control, % de sobretasa no cuadra. \n");
                    $(campo_j).css('border','2px solid red');
			        error++;
			        foco[++cont] = campo_j;
					}
                }
        }  
        });
         $.each($('select'),function(i,v){
        campo_j = "#"+$(this).attr('id');
        if (col2==2)
        {
        e2++;
        col2=1;
        }
		
//Regla 2
        if ($(campo_j).attr('id')=='ddl_F4_S1_P'+e2+'_3')
        {
       
        if ($.trim($('#txt_F4_S1_P'+e2+'_2').val()).length  != 0 && $.trim($('#ddl_F4_S1_P'+e2+'_3').val()).length == 0 )
		    {
					if (perfil == 4)
					{
					mensaje=mensaje +("Campo Fila "+e+" - Advertencia: No indica unidad de medida. \n");
					$(campo_j).css('border','2px solid #FFA500');
					advertencia++;
					foco[++cont] = campo_j;
					}
					else
					{
					mensaje=mensaje +("Campo Fila "+e+" - Error: No indica unidad de medida. \n");
                    $(campo_j).css('border','2px solid red');
			        error++;
			        foco[++cont] = campo_j;
					}							
							
		    }
        } 
 
       // contador de controles de pagina descartando 3 elementos
       if (campo_j.toString() != '#__VIEWSTATE' || campo_j.toString() != '#__EVENTVALIDATION' || campo_j.toString() !='#TextBox1' ||
       campo_j.toString() != '#__EVENTARGUMENT' || campo_j.toString() != '#__EVENTTARGET' || campo_j.toString() != '#__LASTFOCUS')
        {
        col2++ ;
        }    
    });
        
    return [advertencia,error,foco[0],mensaje];
}


